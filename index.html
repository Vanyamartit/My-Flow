<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI Flow - Creative AI platform for generating images, text, and videos using Pollinations AI">
    <title>AI Flow | Pollinations AI Studio</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-animation">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="logo">
            <div class="logo-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                    <path d="M2 17l10 5 10-5"/>
                    <path d="M2 12l10 5 10-5"/>
                </svg>
            </div>
            <span class="logo-text">AI Flow</span>
        </div>

        <nav class="nav-menu">
            <button class="nav-item active" data-tab="image">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                    <circle cx="8.5" cy="8.5" r="1.5"/>
                    <path d="M21 15l-5-5L5 21"/>
                </svg>
                <span>Image</span>
            </button>
            <button class="nav-item" data-tab="text">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                </svg>
                <span>Chat</span>
            </button>
            <button class="nav-item" data-tab="video">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="2" y="4" width="20" height="16" rx="2"/>
                    <path d="M10 9l5 3-5 3V9z"/>
                </svg>
                <span>Video</span>
            </button>
            <button class="nav-item" data-tab="gallery">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"/>
                    <rect x="14" y="3" width="7" height="7"/>
                    <rect x="3" y="14" width="7" height="7"/>
                    <rect x="14" y="14" width="7" height="7"/>
                </svg>
                <span>Gallery</span>
            </button>
        </nav>

        <button class="settings-btn" id="settingsBtn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"/>
                <path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
            </svg>
            <span>Settings</span>
        </button>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Image Generation Tab -->
        <section class="tab-content active" id="tab-image">
            <div class="content-header">
                <h1>üé® Image Generation</h1>
                <p>Create stunning images from text descriptions</p>
            </div>
            
            <div class="generator-panel">
                <div class="input-group">
                    <textarea id="imagePrompt" placeholder="Describe the image you want to create... (e.g., 'A futuristic city at sunset with flying cars')" rows="3"></textarea>
                    <div class="input-actions">
                        <span class="char-count"><span id="imageCharCount">0</span>/500</span>
                        <button class="btn btn-primary" id="generateImageBtn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                            </svg>
                            Generate
                        </button>
                    </div>
                </div>

                <div class="preview-area" id="imagePreview">
                    <div class="preview-placeholder">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <rect x="3" y="3" width="18" height="18" rx="2"/>
                            <circle cx="8.5" cy="8.5" r="1.5"/>
                            <path d="M21 15l-5-5L5 21"/>
                        </svg>
                        <p>Your generated image will appear here</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Chat Tab -->
        <section class="tab-content" id="tab-text">
            <div class="content-header">
                <h1>üí¨ AI Chat</h1>
                <p>Have a conversation with AI</p>
            </div>
            
            <div class="chat-container">
                <div class="chat-messages" id="chatMessages">
                    <div class="message ai-message">
                        <div class="message-avatar">AI</div>
                        <div class="message-content">
                            <p>Hello! I'm your AI assistant powered by Pollinations. How can I help you today?</p>
                        </div>
                    </div>
                </div>
                
                <div class="chat-input-area">
                    <textarea id="chatInput" placeholder="Type your message..." rows="1"></textarea>
                    <button class="btn btn-primary" id="sendChatBtn" aria-label="Send message">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </section>

        <!-- Video Tab -->
        <section class="tab-content" id="tab-video">
            <div class="content-header">
                <h1>üé¨ Video Generation</h1>
                <p>Create videos from text prompts</p>
            </div>
            
            <div class="generator-panel">
                <div class="input-group">
                    <textarea id="videoPrompt" placeholder="Describe the video you want to create... (e.g., 'A butterfly flying through a magical forest')" rows="3"></textarea>
                    <div class="input-actions">
                        <div class="setting-item duration-control">
                            <label for="videoDuration" title="Duration in seconds. Over 10s will generate multiple segments.">‚è±Ô∏è Duration (s):</label>
                            <input type="number" id="videoDuration" value="5" min="1" max="60" step="1">
                        </div>
                        <span class="char-count"><span id="videoCharCount">0</span>/500</span>
                        <button class="btn btn-primary" id="generateVideoBtn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                            </svg>
                            Generate Video
                        </button>
                    </div>
                </div>

                <!-- Frame Mode Selection -->
                <div class="frame-mode-container">
                    <div class="frame-mode-header">
                        <label>First Frame Mode</label>
                        <div class="frame-mode-toggle" id="frameModeToggle">
                            <button class="frame-mode-btn active" data-mode="auto">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                    <path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/>
                                </svg>
                                Automatic
                            </button>
                            <button class="frame-mode-btn" data-mode="custom">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                                    <circle cx="8.5" cy="8.5" r="1.5"/>
                                    <path d="M21 15l-5-5L5 21"/>
                                </svg>
                                Custom Frames
                            </button>
                        </div>
                    </div>
                    
                    <!-- Frame Uploads (hidden by default) -->
                    <div class="frame-uploads hidden" id="frameUploads">
                        <!-- First Frame -->
                        <div class="frame-upload-group">
                            <label>
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                                    <path d="M9 9h6v6H9z"/>
                                </svg>
                                First Frame
                            </label>
                            <div class="frame-upload-zone" id="firstFrameZone">
                                <input type="file" id="firstFrameInput" accept="image/*" class="hidden" title="Select first frame image">
                                <div class="frame-placeholder" id="firstFramePlaceholder">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <rect x="3" y="3" width="18" height="18" rx="2"/>
                                        <line x1="12" y1="8" x2="12" y2="16"/>
                                        <line x1="8" y1="12" x2="16" y2="12"/>
                                    </svg>
                                    <span>Click or drag image</span>
                                </div>
                                <div class="frame-preview hidden" id="firstFramePreview">
                                    <img id="firstFrameImg" src="" alt="First frame">
                                    <button class="frame-clear-btn" id="clearFirstFrame" title="Remove frame">√ó</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Last Frame (Veo only) -->
                        <div class="frame-upload-group hidden" id="lastFrameGroup">
                            <label>
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                                    <path d="M9 9h6v6H9z"/>
                                </svg>
                                Last Frame
                                <span class="label-hint">(Veo interpolation)</span>
                            </label>
                            <div class="frame-upload-zone" id="lastFrameZone">
                                <input type="file" id="lastFrameInput" accept="image/*" class="hidden" title="Select last frame image">
                                <div class="frame-placeholder" id="lastFramePlaceholder">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <rect x="3" y="3" width="18" height="18" rx="2"/>
                                        <line x1="12" y1="8" x2="12" y2="16"/>
                                        <line x1="8" y1="12" x2="16" y2="12"/>
                                    </svg>
                                    <span>Click or drag image</span>
                                </div>
                                <div class="frame-preview hidden" id="lastFramePreview">
                                    <img id="lastFrameImg" src="" alt="Last frame">
                                    <button class="frame-clear-btn" id="clearLastFrame" title="Remove frame">√ó</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="preview-area" id="videoPreview">
                    <div class="preview-placeholder">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <rect x="2" y="4" width="20" height="16" rx="2"/>
                            <path d="M10 9l5 3-5 3V9z"/>
                        </svg>
                        <p>Your generated video will appear here</p>
                        <span class="hint">Video generation may take 1-3 minutes</span>
                    </div>
                </div>
                
                <!-- Multi-segment Visualization -->
                <div class="chain-progress hidden" id="chainProgress">
                    <!-- Segment cards will be injected here -->
                </div>
            </div>

            <!-- Scenes Section for Video Chaining -->
            <div class="scenes-container" id="scenesContainer">
                <div class="scenes-header">
                    <h3>
                        <svg class="icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="2" y="3" width="6" height="5" rx="1"/>
                            <rect x="9" y="3" width="6" height="5" rx="1"/>
                            <rect x="16" y="3" width="6" height="5" rx="1"/>
                            <path d="M5 11v6a2 2 0 002 2h10a2 2 0 002-2v-6"/>
                        </svg>
                        Scenes (Video Chain)
                    </h3>
                    <div class="scenes-actions">
                        <button class="btn btn-primary btn-sm" id="playAllScenesBtn" title="Combine all scenes into one downloadable video">
                            <span class="icon-sm">üé¨</span> Merge & Save Movie
                        </button>
                        <button class="btn btn-secondary btn-sm" id="clearScenesBtn">Clear All</button>
                    </div>
                </div>
                
                <div class="scenes-list" id="scenesList">
                    <div class="scenes-empty">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <rect x="2" y="4" width="20" height="16" rx="2"/>
                            <path d="M10 9l5 3-5 3V9z"/>
                        </svg>
                        <p>Generate a video first, then continue it here</p>
                    </div>
                </div>
                
                <div class="continue-scene-input hidden" id="continueSceneInput">
                    <textarea id="continuePrompt" placeholder="Describe what happens next..." rows="2"></textarea>
                    <button class="btn btn-primary" id="continueSceneBtn">
                        <svg class="icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M5 12h14M12 5l7 7-7 7"/>
                        </svg>
                        Continue
                    </button>
                </div>
            </div>
        </section>

        <!-- Gallery Tab -->
        <section class="tab-content" id="tab-gallery">
            <div class="content-header">
                <h1>üñºÔ∏è Gallery</h1>
                <p>Your generated media collection</p>
            </div>
            
            <div class="gallery-controls">
                <div class="filter-tabs">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="image">Images</button>
                    <button class="filter-btn" data-filter="video">Videos</button>
                </div>
                <button class="btn btn-secondary" id="clearGalleryBtn">Clear All</button>
            </div>
            
            <div class="gallery-grid" id="galleryGrid">
                <div class="gallery-empty">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <rect x="3" y="3" width="18" height="18" rx="2"/>
                        <line x1="12" y1="8" x2="12" y2="16"/>
                        <line x1="8" y1="12" x2="16" y2="12"/>
                    </svg>
                    <p>No media yet. Start generating!</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <div class="modal-header">
                <h2>‚öôÔ∏è Settings</h2>
                <button class="close-btn" id="closeSettings">&times;</button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label for="apiKey">Pollinations API Key</label>
                    <div class="input-with-icon">
                        <input type="password" id="apiKey" placeholder="sk_... or pk_...">
                        <button class="toggle-visibility" id="toggleApiKey" aria-label="Toggle API Key visibility">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                <circle cx="12" cy="12" r="3"/>
                            </svg>
                        </button>
                    </div>
                    <small>
                        <a href="https://enter.pollinations.ai" target="_blank" rel="noopener" class="api-link">Get your API key ‚Üí</a><br>
                        <strong>sk_</strong> (Secret) - Server use, no rate limits, uses Pollen balance<br>
                        <strong>pk_</strong> (Publishable) - Client use, 1 gen/hour per IP<br>
                        Free tier: $3/day for active "Seed" users
                    </small>
                </div>

                <div class="setting-group">
                    <label for="imgbbApiKey">ImgBB API Key (For Video Scenes)</label>
                    <input type="password" id="imgbbApiKey" placeholder="Enter your ImgBB API Key">
                    <small>Required for "Continue" video feature. <a href="https://api.imgbb.com/" target="_blank" rel="noopener noreferrer" class="api-link">Get key here</a></small>
                </div>
                
                <div class="setting-group">
                    <label for="imageModel">Image Model</label>
                    <select id="imageModel">
                        <option value="flux">Flux (Default)</option>
                        <option value="flux-realism">Flux Realism</option>
                        <option value="flux-anime">Flux Anime</option>
                        <option value="flux-3d">Flux 3D</option>
                        <option value="turbo">Turbo (Fast)</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <label for="videoModel">Video Model</label>
                    <select id="videoModel">
                        <option value="seedance-pro">Seedance Pro (Fast)</option>
                        <option value="seedance">Seedance (2-10s)</option>
                        <option value="veo">Veo (4-8s)</option>
                    </select>
                    <small>seedance-pro = fast, seedance = supports image-to-video, veo = text-to-video only</small>
                </div>
                
                <div class="setting-group">
                    <label for="textModel">Text/Chat Model</label>
                    <select id="textModel">
                        <option value="openai">OpenAI Compatible</option>
                        <option value="mistral">Mistral</option>
                        <option value="llama">Llama</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="resetSettings">Reset</button>
                <button class="btn btn-primary" id="saveSettings">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Image Preview Modal -->
    <div class="modal-overlay" id="imageModal">
        <div class="modal modal-large">
            <button class="close-btn modal-close" id="closeImageModal">&times;</button>
            <img id="modalImage" src="" alt="Full size preview">
            <div class="modal-actions">
                <button class="btn btn-primary" id="downloadImage">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    Download
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="app.js"></script>
</body>
</html>
